<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Among Us Guessing Game</title>
    <link rel="stylesheet" href="bootstrap.min.css">
    <style>
/*         html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
        } */

        .container {
            height: 100%;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .score {
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        .result-message {
            font-size: 1.25em;
            font-weight: bold;
            margin-top: 20px;
            color: green;
        }

        .round-info {
            font-size: 1.25em;
            margin-top: 10px;
        }

        .disabled-card {
            background-color: #f8f9fa !important;
            opacity: 0.6;
            pointer-events: none;
        }

        .impostor-text {
            color: red;
            font-weight: bold;
        }

        #nextRoundButton {
            display: none; /* Hidden initially */
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container-lg mt-5">
        <h1 class="text-center mb-4">SUPERSUS - WHITEJACK GAME</h1>

        <!-- Score Display -->
        <div class="score" id="scoreDisplay">
            Score: 0
        </div>

        <div class="card">
            <div class="card-header">
                <h2 class="card-title text-center">Who is the impostor?</h2>
            </div>
            <div class="card-body">
                <div class="row g-3">
                  <div class="col-lg-9 col-sm-9">
                    <div class="row g-3" id="players">

                    </div>
                  </div>
                  <div class="col-lg-3 col-sm-3">
                    <div class="row g-3">
                        <div class="col-lg-12 col-sm-12">
                            <div class="card">
                                <div class="card-header">
                                    <p class="card-title">Meeting Assistant</p>
                                </div>
                                <div class="card-body">
                                    <div class="m-0">Roles in this match:</div>
                                    <div class="mt-0">
                                        Spacecrews 8, Impostors 2
                                    </div>
                                      
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12 col-sm-12">
                          <div class="round-info" id="roundInfo">
                            Round: 1 | Guesses Left: 3
                          </div>
                        </div>
                    </div>
                </div>
                </div>
                <!-- Result Message -->
                <div id="resultMessage" class="result-message" style="display: none;"></div>
                <div id="correctIncorrectDisplay" class="result-message" style="display: none;">
                    Correct Guesses: 0 | Wrong Guesses: 0
                </div>
            </div>
        </div>

        <!-- Next Round Button -->
        <button id="nextRoundButton" class="btn btn-primary" onclick="nextRound()">Go to Next Round</button>
    </div>

    <!-- Modal for Guessing -->
    <div class="modal fade" id="guessModal" tabindex="-1" aria-labelledby="guessModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="guessModalLabel">Make Your Guess</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Do you think this player is an Impostor?</p>
                    <button id="guessYes" class="btn btn-success">Yes</button>
                    <button id="guessNo" class="btn btn-danger">No</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const players = ["BLUE", "RED", "GREEN", "YELLOW", "ORANGE", "PURPLE", "PINK", "BROWN"];
        const impostorsCount = 2;
        let impostors = [];
        let playerRoles = [];
        let score = 0; // Track the player's score
        let round = 1; // Track the current round
        let guessesLeft = 3; // Track guesses left for current round
        let correctGuesses = 0; // Track correct guesses
        let wrongGuesses = 0; // Track wrong guesses

        // Function to generate roles for players
        function generateRoles() {
            const allPlayers = [...players];
            allPlayers.sort(() => Math.random() - 0.5);
            
            impostors = allPlayers.slice(0, impostorsCount);
            playerRoles = allPlayers.map(player => impostors.includes(player) ? 'Impostor' : 'Crewmate');
        }

        // Function to create player cards
        function createPlayerCards() {
            const playerContainer = document.getElementById("players");
            playerContainer.innerHTML = ""; // Clear existing players

            players.forEach((player, index) => {
                const playerCard = document.createElement("div");
                playerCard.classList.add("col-lg-6", "col-sm-6");
                playerCard.setAttribute("id", `player-${player}`);
                playerCard.innerHTML = `
                    <div class="card" style="border-left: 5px solid ${getColorForPlayer(player)};">
                        <div class="card-body d-flex justify-content-between align-items-center" id="card-${player}">
                            <p class="mb-0">${player}</p>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-crosshair" viewBox="0 0 16 16" role="button" style="cursor: pointer;" onclick="showGuessModal('${player}')">
                                <path d="M8.5.5a.5.5 0 0 0-1 0v.518A7 7 0 0 0 1.018 7.5H.5a.5.5 0 0 0 0 1h.518A7 7 0 0 0 7.5 14.982v.518a.5.5 0 0 0 1 0v-.518A7 7 0 0 0 14.982 8.5h.518a.5.5 0 0 0 0-1h-.518A7 7 0 0 0 8.5 1.018zm-6.48 7A6 6 0 0 1 7.5 2.02v.48a.5.5 0 0 0 1 0v-.48a6 6 0 0 1 5.48 5.48h-.48a.5.5 0 0 0 0 1h.48a6 6 0 0 1-5.48 5.48v-.48a.5.5 0 0 0-1 0v.48A6 6 0 0 1 2.02 8.5h.48a.5.5 0 0 0 0-1zM8 10a2 2 0 1 0 0-4 2 2 0 0 0 0 4"/>
                            </svg>
                        </div>
                    </div>
                `;
                playerContainer.appendChild(playerCard);
            });
        }

        // Function to get color for player
        function getColorForPlayer(player) {
            const colorMapping = {
                "BLUE": "blue",
                "RED": "red",
                "GREEN": "green",
                "YELLOW": "yellow",
                "ORANGE": "orange",
                "PURPLE": "purple",
                "PINK": "pink",
                "BROWN": "brown"
            };
            return colorMapping[player] || 'gray';
        }

        // Show Guess Modal
        function showGuessModal(player) {
            const isImpostor = impostors.includes(player);
            
            // Handling the "Yes" button click
            document.getElementById("guessYes").onclick = function() {
                if (isImpostor) {
                    score += 10; // Add points for a correct guess
                    correctGuesses++; // Increment correct guesses
                    displayResult("Correct! This player is an Impostor.");
                    showImpostorStatus(player, true); // Show impostor text
                } else {
                    wrongGuesses++; // Increment wrong guesses
                    displayResult("Wrong! This player is not an Impostor.");
                    showImpostorStatus(player, false); // Show impostor text
                }
                updateScoreDisplay();
                guessesLeft--; // Decrease guess count
                updateRoundInfo();
                updateCorrectIncorrectDisplay();
                disableCard(player); // Disable the card after guessing
                checkEndOfRound();
                closeModal();  // Close the modal immediately after clicking "Yes"
            };

            // Handling the "No" button click (no score change, just close modal)
            document.getElementById("guessNo").onclick = function() {
                showImpostorStatus(player, false); // Show impostor text as "No"
                disableCard(player); // Disable the card after guessing
                closeModal();  // Close the modal immediately after clicking "No"
            };

            // Open the modal
            new bootstrap.Modal(document.getElementById('guessModal')).show();
        }

        // Show Impostor Text on the Card
        function showImpostorStatus(player, isImpostor) {
    const cardBody = document.getElementById(`card-${player}`);
    const impostorText = document.createElement('p');
    
    // Add the 'impostor-text' and 'mb-0' classes
    impostorText.classList.add('impostor-text', 'mb-0');
    
    // Set the text based on whether it's an Impostor or Spacecrew
    impostorText.innerText = isImpostor ? "Impostor" : "Spacecrew";
    
    // Set the text color based on the role
    if (isImpostor) {
        impostorText.style.color = 'red';  // Impostor is red
    } else {
        impostorText.style.color = 'blue'; // Spacecrew is blue
    }
    
    // Adjust the font size based on text length
    const textLength = impostorText.innerText.length;
    impostorText.style.fontSize = (textLength > 30) ? "0.9em" : "1.1em";

    // Append the text to the card
    cardBody.appendChild(impostorText);
}


        // Disable the player card and hide the icon
        function disableCard(player) {
            const playerCard = document.getElementById(`player-${player}`);
            const icon = playerCard.querySelector('svg'); // Get the icon (SVG element)
            
            playerCard.classList.add("disabled-card"); // Disable the card
            if (icon) {
                icon.style.display = "none"; // Hide the icon
            }
        }

        // Function to check if the round is over
        function checkEndOfRound() {
            if (guessesLeft <= 0) {
                // Show "Next Round" button when guesses are finished
                document.getElementById("nextRoundButton").style.display = "block";
            }
        }

        // Function to go to the next round
        function nextRound() {
            round++;
            guessesLeft = 3; // Reset guesses for next round
            generateRoles(); // Shuffle impostors and roles
            createPlayerCards(); // Refresh player cards
            updateRoundInfo();
            document.getElementById("nextRoundButton").style.display = "none"; // Hide next round button
        }

        // Display result message
        function displayResult(message) {
            const resultMessage = document.getElementById("resultMessage");
            resultMessage.style.display = "block";
            resultMessage.textContent = message;
            setTimeout(function() {
                resultMessage.style.display = "none"; // Hide the message after 3 seconds
            }, 3000);
        }

        // Update the round and guesses display
        function updateRoundInfo() {
            document.getElementById("roundInfo").innerText = `Round: ${round} | Guesses Left: ${guessesLeft}`;
        }

        // Update the score display
        function updateScoreDisplay() {
            document.getElementById("scoreDisplay").innerText = `Score: ${score}`;
        }

        // Update the correct and wrong guesses display
        function updateCorrectIncorrectDisplay() {
            document.getElementById("correctIncorrectDisplay").style.display = "block";
            document.getElementById("correctIncorrectDisplay").innerText = `Correct Guesses: ${correctGuesses} | Wrong Guesses: ${wrongGuesses}`;
        }

        // Close the modal programmatically
        function closeModal() {
            const modal = bootstrap.Modal.getInstance(document.getElementById('guessModal'));
            modal.hide();  // This hides the modal
        }

        // Initial setup
        generateRoles();
        createPlayerCards();
    </script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
